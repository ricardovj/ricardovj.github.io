<html>
  <head>
    <title>DataViz</title>
    <style type="text/css">
      #viz {
        width: 2400px;
        height: 1400px;
      }
    </style>
    <script
      src="https://code.jquery.com/jquery-3.2.1.min.js"
      integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
      crossorigin="anonymous"
    ></script>
    <script src="neovis.js"></script>
  </head>
  <script>
    var timeout = null

    function drawDebounced() {
      clearTimeout(timeout)
      timeout = setTimeout(draw, 1000)
    }

    function draw() {
      var searchString = $('#cypher').val()

      var config = {
        encrypted: 'ENCRYPTION_ON',
        trust: 'TRUST_CUSTOM_CA_SIGNED_CERTIFICATES',
        container_id: 'viz',
        server_url:
          'bolt://hobby-abcpnjmgjfpbgbkedicbadcl.dbs.graphenedb.com:24787',
        server_user: 'app73707340-lAdgkl',
        server_password: 'b.GWA0HLI6MAiL.OPLow1PLt3lyaa5G',
        labels: {
          GraphTopic: {
            caption: 'name',
            size: 'size',
            community: 'community'
          }
        },
        relationships: {
          SUBTOPIC_OF: {
            caption: false
          }
        },
        arrows: true,
        solver: 'barnesHut',
        physics: true,
        // initial_cypher:
        //   'MATCH (t) WHERE t.name =~ "(?i)law.*"  OPTIONAL MATCH (t)-[r]-(s) RETURN t, r, s'
        // 'MATCH (t) WHERE t.id <> 251 OPTIONAL MATCH (t)-[r]-(s) RETURN t, r, s'
        initial_cypher:
          'MATCH (child)-[r:SUBTOPIC_OF*0..]->(root)' +
          `WHERE root.name =~ "(?i)${searchString}.*"` +
          'OPTIONAL MATCH (root)-[rootParentRelationship]->(rootParent)' +
          'OPTIONAL MATCH (child)-[childParentRelationship]->(childParent)' +
          'RETURN root, rootParent, r, childParentRelationship, rootParentRelationship, childParent, COLLECT(child) AS tree'
      }

      var viz = new NeoVis.default(config)
      viz.render()
    }
  </script>
  <body onload="draw()">
    <span>Topic Name:</span>
    <input id="cypher" type="text" value="math" oninput="drawDebounced()" />
    <div id="viz"></div>
  </body>
</html>
